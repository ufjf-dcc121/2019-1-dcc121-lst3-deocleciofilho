<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Jogo da Velha</title>
    <link rel="stylesheet" href="estilo.css">
</head>

<body>

    <div class="jogo">

        <div id="a1" class="quadrado" jogada=""></div>
        <div id="a2" class="quadrado" jogada=""> </div>
        <div id="a3" class="quadrado" jogada=""></div>
        <div id="b1" class="quadrado" jogada=""></div>
        <div id="b2" class="quadrado" jogada=""></div>
        <div id="b3" class="quadrado" jogada=""></div>
        <div id="c1" class="quadrado" jogada=""></div>
        <div id="c2" class="quadrado" jogada=""></div>
        <div id="c3" class="quadrado" jogada=""></div>

        <div id = "risco" class="r0">
            <img id="img2" class="imgP" >
        </div>

    </div>


    <div id="caixa" class="caixa">

        <div id=msg><b>
                <p><img id="img1" src="imagens/x1.png"> <span id=jgd> </span></p>
            </b>
        </div>
        <button id="btnreiniciar" type="reset" disabled="true"> Reiniciar Jogo </button>
    </div>

    <script>

        var jgX = "X";
        var jgY = "O";
        var jogador = jgX;
        var fimdojogo = false;
        var images = new Array();

        var sequence = [];
        var actualRound = 0;
        var seqPos = 0;
        var msg = document.getElementById("msg");
        var btnreiniciar = document.getElementById("btnreiniciar");
        var jogadorDaVez = document.querySelectorAll("div#caixa #img1")[0];
        var jogadoragora = document.getElementById("jgd");
        var img2 = document.getElementById("img2");

        preloadImages("imagens/x1.png", "imagens/o1.png")
        atualizaPlacar();
        enderecaQuadrados();

        btnreiniciar.addEventListener("click", function () {
            location.reload();
        });

        function preloadImages() {
            for (i = 0; i < preloadImages.arguments.length; i++) {
                images[i] = new Image()
                images[i].src = preloadImages.arguments[i]
            }
        }


        function atualizaPlacar() {

            if (fimdojogo) {
                return;
            }
            if (jogador == jgX) {
                jogadoragora.textContent = "1º Jogador"
                jogadorDaVez.setAttribute("src", images[0].src);
            } else {
                jogadoragora.textContent = "2º Jogador"
                jogadorDaVez.setAttribute("src", images[1].src);
            }
        }

        function enderecaQuadrados() {

            var quadrados = document.getElementsByClassName("quadrado");
            for (var i = 0; i < quadrados.length; i++) {

                quadrados[i].innerHTML = "<img id='p1' src='" + images[0].src +
                    "' border='0'><img id='p2' src='" +
                    images[1].src + "' border='0'>";

                quadrados[i].getElementsByTagName('img')[0].style.display = "none";
                quadrados[i].getElementsByTagName('img')[1].style.display = "none";

                quadrados[i].addEventListener("click", function () {

                    if (fimdojogo) {
                        return;
                    }

                    if (this.getAttribute("jogada") == "") {

                        if (jogador == jgX) {
                            this.getElementsByTagName('img')[0].style.display = "inline";
                            this.setAttribute("jogada", jgX);
                            jogador = jgY;

                        } else {
                            this.getElementsByTagName('img')[1].style.display = "inline";
                            this.setAttribute("jogada", jgY);
                            jogador = jgX;
                        }
                        atualizaPlacar();
                        analisaJogada();

                    }

                });
            }
        }

        function analisaJogada() {


            var a1 = document.getElementById("a1").getAttribute("jogada");
            var a2 = document.getElementById("a2").getAttribute("jogada");
            var a3 = document.getElementById("a3").getAttribute("jogada");

            var b1 = document.getElementById("b1").getAttribute("jogada");
            var b2 = document.getElementById("b2").getAttribute("jogada");
            var b3 = document.getElementById("b3").getAttribute("jogada");

            var c1 = document.getElementById("c1").getAttribute("jogada");
            var c2 = document.getElementById("c2").getAttribute("jogada");
            var c3 = document.getElementById("c3").getAttribute("jogada");

            var vencedor = "";

            // verificando o vencedor

            if (((a1 == b1 && a1 == c1) ||
                (a1 == a2 && a1 == a3) ||
                (a1 == b2 && a1 == c3)) &&
                a1 != "") {
                vencedor = a1;

            } else if ((b2 == b1 && b2 == b3 && b2 != "") ||
                (b2 == a2 && b2 == c2 && b2 != "") ||
                (b2 == a3 && b2 == c1 && b2 != "")) {
                vencedor = b2;

            } else if (((c3 == c2 && c3 == c1) ||
                (c3 == a3 && c3 == b3)) &&
                c3 != "") {
                vencedor = c3;
            }

            /// Inserindo os riscos

            // verticais
            if (a1 == b1 && a1 == c1 && vencedor == "X" && a1 != ""){
                img2.src = "imagens/riscovEA.png";
                document.getElementById("risco").style.zIndex = "1";
            }else if (a1 == b1 && a1 == c1 && vencedor == "O" && a1 != ""){
                img2.src = "imagens/riscovEV.gif";
                document.getElementById("risco").style.zIndex = "1";
            }

            if (a2 == b2 && a2 == c2 && vencedor == "X" && a2 != "") {
                img2.src = "imagens/riscovMA.png";
                document.getElementById("risco").style.zIndex = "1";
            } else if (a2 == b2 && a2 == c2 && vencedor == "O" && a2 != "") {
                img2.src = "imagens/riscovMV.gif";
                document.getElementById("risco").style.zIndex = "1";
            }

            if (a3 == b3 && a3 == c3 && vencedor == "X" && a3 != "") {
                img2.src = "imagens/riscovDA.png";
                document.getElementById("risco").style.zIndex = "1";
            } else if (a3 == b3 && a3 == c3 && vencedor == "O" && a3 != "") {
                img2.src = "imagens/riscovDV.gif";
                document.getElementById("risco").style.zIndex = "1";
            }


            //horizontais

            if (a1 == a2 && a1 == a3 && vencedor == "X" && a1 != "") {
                img2.src = "imagens/riscohCA.png";
                document.getElementById("risco").style.zIndex = "1";
            } else if (a1 == a2 && a1 == a3 && vencedor == "O" && a1 != "")  {
                img2.src = "imagens/riscohCV.gif";
                document.getElementById("risco").style.zIndex = "1";
            }

            if (b1 == b2 && b1 == b3 && vencedor == "X" && b1 != "") {
                img2.src = "imagens/riscohMA.png";
                document.getElementById("risco").style.zIndex = "1";
            } else if (b1 == b2 && b1 == b3 && vencedor == "O" && b1 != "") {
                img2.src = "imagens/riscohMV.gif";
                document.getElementById("risco").style.zIndex = "1";
            }

            if (c1 == c2 && c1 == c3 && vencedor == "X" && c1 != "") {
                img2.src = "imagens/riscohBA.png";
                document.getElementById("risco").style.zIndex = "1";
            } else if (c1 == c2 && c1 == c3 && vencedor == "O" && c1 != "")  {
                img2.src = "imagens/riscohBV.gif";
                document.getElementById("risco").style.zIndex = "1";
            }

            //Transversais

            if (a1 == b2 && a1 == c3 && vencedor == "X" && a1 != "") {
                img2.src = "imagens/riscoeA.png";
                document.getElementById("risco").style.zIndex = "1";
            } else if (a1 == b2 && a1 == c3 && vencedor == "O" && a1 != "") {
                img2.src = "imagens/riscoeV.gif";
                document.getElementById("risco").style.zIndex = "1";
            }
            if (a3 == b2 && a3 == c1 && vencedor == "X" && a3 != "") {
                img2.src = "imagens/riscodA.png";
                document.getElementById("risco").style.zIndex = "1";
            } else if (a3 == b2 && a3 == c1 && vencedor == "O" && a3 != "") {
                img2.src = "imagens/riscodV.gif";
                document.getElementById("risco").style.zIndex = "1";
            }

            //Quem venceu ???

            if (vencedor != "") {
                fimdojogo = true;
                var m = "Parabéns!!! Você venceu";

                if (vencedor == "X") {
                    vencedor = " 1º Jogador.";
                } else {
                    vencedor = " 2º Jogador.";
                }

                msg.textContent = m + vencedor;
                btnreiniciar.disabled = false;
            }

            if (a1 != "" && a2 != "" && a3 != "" &&
                b1 != "" && b2 != "" && b3 != "" &&
                c1 != "" && c2 != "" && c3 != "") {

                fimdojogo = true;

                var m = "Empate!!! Fim do jogo";
                msg.textContent = m;
                btnreiniciar.disabled = false;
            }
        }

    </script>

</body>

</html>